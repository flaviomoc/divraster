<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Absolute or Percentage Difference Between SpatRaster Objects — differ.rast • divraster</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Absolute or Percentage Difference Between SpatRaster Objects — differ.rast"><meta name="description" content="Computes the difference between two SpatRaster objects, either as an absolute value
or as a percentage of change relative to the first raster (r1).
This function is commonly used to assess changes in spatial patterns, such as
shifts in species richness or environmental variables over time or between scenarios."><meta property="og:description" content="Computes the difference between two SpatRaster objects, either as an absolute value
or as a percentage of change relative to the first raster (r1).
This function is commonly used to assess changes in spatial patterns, such as
shifts in species richness or environmental variables over time or between scenarios."><meta property="og:image" content="https://flaviomoc.github.io/divraster/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">divraster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/divraster-vignette.html">divraster-vignette</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/flaviomoc/divraster/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate Absolute or Percentage Difference Between SpatRaster Objects</h1>
      <small class="dont-index">Source: <a href="https://github.com/flaviomoc/divraster/blob/master/R/diff_rast.R" class="external-link"><code>R/diff_rast.R</code></a></small>
      <div class="d-none name"><code>differ.rast.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes the difference between two <code>SpatRaster</code> objects, either as an absolute value
or as a percentage of change relative to the first raster (<code>r1</code>).
This function is commonly used to assess changes in spatial patterns, such as
shifts in species richness or environmental variables over time or between scenarios.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">differ.rast</span><span class="op">(</span><span class="va">r1</span>, <span class="va">r2</span>, perc <span class="op">=</span> <span class="cn">TRUE</span>, filename <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-r-">r1<a class="anchor" aria-label="anchor" href="#arg-r-"></a></dt>
<dd><p>A <code>SpatRaster</code> object representing the baseline or initial values.
Can have one or multiple layers.</p></dd>


<dt id="arg-r-">r2<a class="anchor" aria-label="anchor" href="#arg-r-"></a></dt>
<dd><p>A <code>SpatRaster</code> object representing the future or comparison values.
Must have the same dimensions, resolution, CRS, and number of layers as <code>r1</code>.</p></dd>


<dt id="arg-perc">perc<a class="anchor" aria-label="anchor" href="#arg-perc"></a></dt>
<dd><p>Logical (default is <code>TRUE</code>). If <code>TRUE</code>, the percentage of change
relative to <code>r1</code> is calculated: <code>((r2 - r1) / r1) * 100</code>.
If <code>FALSE</code>, the absolute difference (<code>r2 - r1</code>) is returned.</p></dd>


<dt id="arg-filename">filename<a class="anchor" aria-label="anchor" href="#arg-filename"></a></dt>
<dd><p>Character string. Optional path and filename to save the resulting
<code>SpatRaster</code>. Supported formats are those recognized by <code><a href="https://rspatial.github.io/terra/reference/writeRaster.html" class="external-link">terra::writeRaster</a></code>
(e.g., ".tif", ".grd"). If provided, the <code>SpatRaster</code> will be saved to
this file.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>SpatRaster</code> object containing the calculated differences.</p><ul><li><p>If <code>perc = TRUE</code>, the layer name will be "Percentage_Difference".</p></li>
<li><p>If <code>perc = FALSE</code>, the layer name will be "Absolute_Difference".</p></li>
</ul><p>The output <code>SpatRaster</code> will have the same dimensions, resolution, and CRS as
the input rasters.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function performs a cell-wise subtraction (<code>r2 - r1</code>).</p><ul><li><p>For <strong>percentage difference</strong>, the formula used is <code>((r2 - r1) / r1) * 100</code>.
Cells where <code>r1</code> is <code>NA</code> or <code>0</code> will result in <code>NA</code> in the output
<code>SpatRaster</code> for percentage calculations, to avoid division by zero or
meaningless percentages.</p></li>
<li><p>It is crucial that <code>r1</code> and <code>r2</code> are aligned spatially (same extent,
resolution, and Coordinate Reference System - CRS) and have the
same number of layers, with corresponding layers representing the
same variable or species.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load rasters</span></span></span>
<span class="r-in"><span><span class="va">rich1</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"rich_ref.tif"</span>,</span></span>
<span class="r-in"><span>package <span class="op">=</span> <span class="st">"divraster"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rich2</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"rich_fut.tif"</span>,</span></span>
<span class="r-in"><span>package <span class="op">=</span> <span class="st">"divraster"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate absolute difference in richness</span></span></span>
<span class="r-in"><span><span class="va">abs_diff_rast</span> <span class="op">&lt;-</span> <span class="fu">differ.rast</span><span class="op">(</span><span class="va">rich1</span>, <span class="va">rich2</span>, perc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">abs_diff_rast</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class       : SpatRaster </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> size        : 8, 8, 1  (nrow, ncol, nlyr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> resolution  : 0.125, 0.125  (x, y)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extent      : 0, 1, 0, 1  (xmin, xmax, ymin, ymax)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> coord. ref. : lon/lat WGS 84 (EPSG:4326) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> source(s)   : memory</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> varname     : rich_fut </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> name        : Absolute_Difference </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> min value   :                  -5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> max value   :                   5 </span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">abs_diff_rast</span>, main <span class="op">=</span> <span class="st">"Absolute Difference in Richness"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="differ.rast-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate percentage difference in richness</span></span></span>
<span class="r-in"><span><span class="va">perc_diff_rast</span> <span class="op">&lt;-</span> <span class="fu">differ.rast</span><span class="op">(</span><span class="va">rich1</span>, <span class="va">rich2</span>, perc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">perc_diff_rast</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class       : SpatRaster </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> size        : 8, 8, 1  (nrow, ncol, nlyr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> resolution  : 0.125, 0.125  (x, y)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extent      : 0, 1, 0, 1  (xmin, xmax, ymin, ymax)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> coord. ref. : lon/lat WGS 84 (EPSG:4326) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> source(s)   : memory</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> varname     : rich_fut </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> name        : Percentage_Difference </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> min value   :             -71.42857 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> max value   :             200.00000 </span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">perc_diff_rast</span>, main <span class="op">=</span> <span class="st">"Percentage Difference in Richness"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="differ.rast-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Flávio M. M. Mota, Neander Marcel Heming, Gabriela Alves-Ferreira.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

