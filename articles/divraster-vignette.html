<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>divraster-vignette • divraster</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="divraster-vignette">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">divraster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/divraster-vignette.html">divraster-vignette</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/flaviomoc/divraster/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>divraster-vignette</h1>
                        <h4 data-toc-skip class="author">Flávio M. M.
Mota, Neander M. Heming, and Gabriela Alves-Ferreira</h4>
            
            <h4 data-toc-skip class="date">2025-05-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/flaviomoc/divraster/blob/master/vignettes/divraster-vignette.Rmd" class="external-link"><code>vignettes/divraster-vignette.Rmd</code></a></small>
      <div class="d-none name"><code>divraster-vignette.Rmd</code></div>
    </div>

    
    
<ul>
<li><a href="#intro">1 Introduction</a></li>
<li>
<a href="#alpha">2 Alpha diversity</a>
<ul>
<li>
<a href="#alpha-ex">2.1 Alpha examples</a>
<ul>
<li><a href="#alpha-td">2.1.1 Alpha TD</a></li>
<li><a href="#alpha-fd">2.1.2 Alpha FD</a></li>
<li><a href="#alpha-pd">2.1.3 Alpha PD</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#ses">3 Standardized effect size (SES)</a>
<ul>
<li>
<a href="#ses-ex">3.1 SES examples</a>
<ul>
<li><a href="#ses-fd">3.1.1 SES FD</a></li>
<li><a href="#ses-pd">3.1.2 SES PD</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#beta">4 Beta diversity</a>
<ul>
<li>
<a href="#betaspat-ex">4.1 Beta examples</a>
<ul>
<li><a href="#betaspat-td">4.1.1 Beta spatial TD</a></li>
<li><a href="#betaspat-fd">4.1.2 Beta spatial FD</a></li>
<li><a href="#betaspat-pd">4.1.3 Beta spatial PD</a></li>
<li><a href="#betatemp-td">4.1.4 Beta temporal TD</a></li>
<li><a href="#betatemp-fd">4.1.5 Beta temporal FD</a></li>
<li><a href="#betatemp-pd">4.1.6 Beta temporal PD</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#traits-avg">5 Traits average</a>
<ul>
<li><a href="#traits-ex">5.1 Traits average examples</a></li>
</ul>
</li>
<li><a href="#suit-change">6 Suitability change</a></li>
<li><a href="#area-calc">7 Area calculation</a></li>
<li><a href="#differ">8 Richness difference between scenarios</a></li>
</ul>
<div class="section level2">
<h2 id="intro">1 Introduction<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>Macroecological studies have been increasingly utilized in the
context of climate change, necessitating the use of tools to analyze
large datasets. To examine and comprehend the intricate mechanisms that
underlie species distributions and the structure of biological
communities, a diverse array of metrics has been developed. These
metrics encompass alpha and beta diversity patterns across taxonomic
(TD), functional (FD), and phylogenetic (PD) dimensions. The package
<code>divraster</code> addresses a current gap in this field by offering
functions to calculate diversity metrics directly from rasters,
eliminating the need for matrix transformations. This capability is
especially valuable when dealing with extensive datasets, as matrices
often impose memory constraints.</p>
</div>
<div class="section level2">
<h2 id="alpha">2 Alpha calculations<a class="anchor" aria-label="anchor" href="#alpha"></a>
</h2>
<p>Alpha diversity calculations use a tree-based approach for taxonomic
(TD), functional (FD), and phylogenetic (PD) diversity. In the FD
calculation, a species traits matrix is converted into a distance matrix
and clustered to produce a regional dendrogram (i.e. a dendrogram with
all species in the raster stack) from which the total branch length is
calculated. When calculating FD for each community (i.e. raster cell),
the regional dendrogram is subsetted into a local dendrogram containing
only the species present on the local community, and only the branch
lengths connecting them are summed to represent the functional
relationships of the species locally present. Similarly, in PD, the sum
of branch lengths connecting species within a community represents their
shared phylogenetic relationships and cumulative evolutionary history.
Alpha TD can also be visualized using a tree diagram, where each species
is directly connected to the root by an edge of unit length, reflecting
the number of different taxa in the community (i.e. species richness)
since all taxa are at the same level.</p>
</div>
<div class="section level2">
<h2 id="alpha-ex">2.1 Alpha examples<a class="anchor" aria-label="anchor" href="#alpha-ex"></a>
</h2>
</div>
<div class="section level2">
<h2 id="alpha-td">2.1.1 Alpha TD<a class="anchor" aria-label="anchor" href="#alpha-td"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Loading data</span></span>
<span><span class="co"># Presence-absence SpatRaster</span></span>
<span><span class="va">bin1</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, </span>
<span>                                <span class="st">"ref_frugivor.tif"</span>, </span>
<span>                                package <span class="op">=</span> <span class="st">"divraster"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bin2</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                                <span class="st">"fut_frugivor.tif"</span>,</span>
<span>                                package <span class="op">=</span> <span class="st">"divraster"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Change extension to process faster</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">bin1</span><span class="op">)</span></span>
<span><span class="co">#&gt; SpatExtent : -41.875, -38.75, -21.375, -13 (xmin, xmax, ymin, ymax)</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">41</span>, <span class="op">-</span><span class="fl">39</span>, <span class="op">-</span><span class="fl">15</span>, <span class="op">-</span><span class="fl">13</span><span class="op">)</span></span>
<span><span class="va">bin1</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="va">bin1</span>, <span class="va">e</span><span class="op">)</span></span>
<span><span class="va">bin2</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="va">bin2</span>, <span class="va">e</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Species traits</span></span>
<span><span class="va">traits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, </span>
<span>                               <span class="st">"traits_frugivor.csv"</span>, </span>
<span>                               package <span class="op">=</span> <span class="st">"divraster"</span><span class="op">)</span>, </span>
<span>                   sep <span class="op">=</span> <span class="st">";"</span>, </span>
<span>                   row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Phylogenetic tree</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, </span>
<span>                                   <span class="st">"tree_frugivor.tre"</span>, </span>
<span>                                   package <span class="op">=</span> <span class="st">"divraster"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alpha TD calculation for scenario 1</span></span>
<span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/spat.alpha.html">spat.alpha</a></span><span class="op">(</span><span class="va">bin1</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 16, 16, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.125, 0.125  (x, y)</span></span>
<span><span class="co">#&gt; extent      : -41, -39, -15, -13  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; name        : Alpha_TD </span></span>
<span><span class="co">#&gt; min value   :        0 </span></span>
<span><span class="co">#&gt; max value   :       67</span></span>
<span></span>
<span><span class="co"># Alpha TD calculation for scenario 2</span></span>
<span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/spat.alpha.html">spat.alpha</a></span><span class="op">(</span><span class="va">bin2</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 16, 16, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.125, 0.125  (x, y)</span></span>
<span><span class="co">#&gt; extent      : -41, -39, -15, -13  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; name        : Alpha_TD </span></span>
<span><span class="co">#&gt; min value   :        0 </span></span>
<span><span class="co">#&gt; max value   :       65</span></span></code></pre></div>
<p>The alpha taxonomic diversity in the first scenario ranges from 0 to
67, and in the second scenario, it ranges from 0 to 65, with higher
values concentrated towards the north in both cases.</p>
</div>
<div class="section level2">
<h2 id="alpha-fd">2.1.2 Alpha FD<a class="anchor" aria-label="anchor" href="#alpha-fd"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/spat.alpha.html">spat.alpha</a></span><span class="op">(</span><span class="va">bin1</span>, <span class="va">traits</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 16, 16, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.125, 0.125  (x, y)</span></span>
<span><span class="co">#&gt; extent      : -41, -39, -15, -13  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; name        : Alpha_FD </span></span>
<span><span class="co">#&gt; min value   : 3.723151 </span></span>
<span><span class="co">#&gt; max value   : 4.378846</span></span></code></pre></div>
<p>The alpha functional diversity for the first scenario ranges from 3.7
to 4.4, with higher values concentrated towards the north, indicating
greater functional diversity.</p>
</div>
<div class="section level2">
<h2 id="alpha-pd">2.1.3 Alpha PD<a class="anchor" aria-label="anchor" href="#alpha-pd"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Alpha PD calculation</span></span>
<span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/spat.alpha.html">spat.alpha</a></span><span class="op">(</span><span class="va">bin1</span>, <span class="va">tree</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 16, 16, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.125, 0.125  (x, y)</span></span>
<span><span class="co">#&gt; extent      : -41, -39, -15, -13  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; name        : Alpha_PD </span></span>
<span><span class="co">#&gt; min value   : 1523.921 </span></span>
<span><span class="co">#&gt; max value   : 1859.668</span></span></code></pre></div>
<p>The alpha phylogenetic diversity for the first scenario ranges from
1524 to 1860, with higher values concentrated towards the north,
indicating greater phylogenetic diversity.</p>
</div>
<div class="section level2">
<h2 id="ses">3 Standardized effect size (SES)<a class="anchor" aria-label="anchor" href="#ses"></a>
</h2>
<p>SES is often used in ecological studies to measure the magnitude of
difference between observed and randomized patterns generated by null
models, expressed in standard deviation units. We calculate SES using
the <code>SESraster</code> package, which currently offers six community
randomization methods. The basic randomization methods include: keeping
the richness constant and randomizing the position of the species within
each raster cell (site), keeping range size constant and randomizing the
position of species presences in space (species), and randomizing by
both site and species simultaneously (both). A positive SES indicates
that the observed functional/phylogenetic diversity is higher than
expected solely based on species richness (taxonomic diversity), whereas
a negative SES indicates the opposite.</p>
</div>
<div class="section level2">
<h2 id="ses-ex">3.1 SES examples<a class="anchor" aria-label="anchor" href="#ses-ex"></a>
</h2>
</div>
<div class="section level2">
<h2 id="ses-fd">3.1.1 SES FD<a class="anchor" aria-label="anchor" href="#ses-fd"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># SES FD calculation</span></span>
<span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/spat.rand.html">spat.rand</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bin1</span>, </span>
<span>                               tree <span class="op">=</span> <span class="va">traits</span>, </span>
<span>                               aleats <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                               random <span class="op">=</span> <span class="st">"site"</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 16, 16, 4  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.125, 0.125  (x, y)</span></span>
<span><span class="co">#&gt; extent      : -41, -39, -15, -13  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; names       :  Mean_FD,       SD_FD, Observed_FD,     SES_FD </span></span>
<span><span class="co">#&gt; min values  : 3.711791, 0.002639008,    3.723151, -18.594535 </span></span>
<span><span class="co">#&gt; max values  : 4.424008, 0.166680920,    4.378846,   4.860787</span></span></code></pre></div>
<p>The SES indicates that the majority of the areas have values close to
0, suggesting that functional diversity does not significantly differ
from the expected change. However, one community is projected to be
functionally dispersed (SES_FD = 31), while another community is
projected to be functionally clustered (SES_FD = -39). This indicates an
increase and decrease in functional diversity within these communities
from scenarios 1 to 2, respectively.</p>
</div>
<div class="section level2">
<h2 id="ses-pd">3.1.2 SES PD<a class="anchor" aria-label="anchor" href="#ses-pd"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># SES PD calculation</span></span>
<span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/spat.rand.html">spat.rand</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bin1</span>, </span>
<span>                               tree <span class="op">=</span> <span class="va">tree</span>, </span>
<span>                               aleats <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                               random <span class="op">=</span> <span class="st">"site"</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 16, 16, 4  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.125, 0.125  (x, y)</span></span>
<span><span class="co">#&gt; extent      : -41, -39, -15, -13  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; names       :  Mean_PD,     SD_PD, Observed_PD,    SES_PD </span></span>
<span><span class="co">#&gt; min values  : 1617.695,  1.585962,    1623.451, -4.664356 </span></span>
<span><span class="co">#&gt; max values  : 1875.081, 97.284872,    1880.676, 11.069075</span></span></code></pre></div>
<p>Similarly, the SES for phylogenetic diversity does not differ from
what is expected by chance, with most communities presenting values
close to 0. However, one community is projected to be phylogenetically
dispersed (SES_PD = 10), while another community is projected to be
phylogenetically clustered (SES_FD = -15). This indicates an increase
and decrease in phylogenetic diversity within these communities from
scenarios 1 to 2, respectively.</p>
</div>
<div class="section level2">
<h2 id="beta">4 Beta diversity<a class="anchor" aria-label="anchor" href="#beta"></a>
</h2>
<p>Beta diversity captures variations in species composition between
different communities. When examining a community in comparison to its
neighboring ones, it is referred to as spatial beta diversity. On the
other hand, when assessing changes within the same community over
different time periods, it is termed temporal beta diversity. Beta
diversity can further be partitioned into two components: “replacement”
and “richness differences”. The former accounts for the substitution of
one species with another, while the latter encompasses discrepancies in
the total number of species (e.g. species gain or loss). In addition,
since Btotal represents the sum of Brepl and Brich components, the
proportion of Brepl/Btotal (Bratio) can be calculated, with values close
to 0 indicating the predominance of Brich and values close to 1
indicating the predominance of Brepl. Moreover, the concept of beta
diversity extends to functional (FD) and phylogenetic diversity (PD),
using the same framework as taxonomic diversity (TD). In the context of
TD, higher beta diversity represents higher dissimilarities in species
composition between communities. In contrast, for FD, it indicates
higher dissimilarities in functional traits, and for PD, it reflects
higher dissimilarities in phylogenetic relationships of species between
communities.</p>
</div>
<div class="section level2">
<h2 id="betaspat-ex">4.1 Beta examples<a class="anchor" aria-label="anchor" href="#betaspat-ex"></a>
</h2>
</div>
<div class="section level2">
<h2 id="betaspat-td">4.1.1 Beta spatial TD<a class="anchor" aria-label="anchor" href="#betaspat-td"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Beta spatial TD calculation</span></span>
<span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/spat.beta.html">spat.beta</a></span><span class="op">(</span><span class="va">bin1</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 16, 16, 4  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 1, 1  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 0, 16, 0, 16  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. :  </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; names       :      Btotal,      Brepl,       Brich, Bratio </span></span>
<span><span class="co">#&gt; min values  : 0.003030303, 0.00000000, 0.001865672,    0.0 </span></span>
<span><span class="co">#&gt; max values  : 0.103833944, 0.03076923, 0.103181683,    0.8</span></span></code></pre></div>
<p>Spatial beta diversity for TD indicates a slight change in species
composition towards the south, as evidenced by the small values of
Btotal (~0.1). The predominant component contributing to this change is
the richness difference (Brich), suggesting that dissimilarities between
each community (i.e. pixel) and its neighbors are primarily due to the
loss or gain of species. The Bratio also indicates the predominance of
Birch component in most communities.</p>
</div>
<div class="section level2">
<h2 id="betaspat-fd">4.1.2 Beta spatial FD<a class="anchor" aria-label="anchor" href="#betaspat-fd"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Beta spatial FD calculation</span></span>
<span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/spat.beta.html">spat.beta</a></span><span class="op">(</span><span class="va">bin1</span>, <span class="va">traits</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 16, 16, 4  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 1, 1  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 0, 16, 0, 16  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. :  </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; names       :       Btotal,       Brepl,        Brich,    Bratio </span></span>
<span><span class="co">#&gt; min values  : 0.0003396686, 0.000000000, 0.0003396686, 0.0000000 </span></span>
<span><span class="co">#&gt; max values  : 0.0793045655, 0.008671016, 0.0793045655, 0.5181554</span></span></code></pre></div>
<p>Similarly, spatial beta diversity for FD indicates a slight change in
functional traits composition towards the south, as evidenced by the
small values of Btotal (~0.08). The predominant component contributing
to this little change is the richness difference (Brich), suggesting
that dissimilarities between each community (i.e. pixel) and its
neighbors are primarily due to the loss or gain of functional traits.
The Bratio also indicates the predominance of Birch component in most
communities.</p>
</div>
<div class="section level2">
<h2 id="betaspat-pd">4.1.3 Beta spatial PD<a class="anchor" aria-label="anchor" href="#betaspat-pd"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Beta spatial PD calculation</span></span>
<span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/spat.beta.html">spat.beta</a></span><span class="op">(</span><span class="va">bin1</span>, <span class="va">tree</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 16, 16, 4  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 1, 1  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 0, 16, 0, 16  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. :  </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; names       :       Btotal,       Brepl,        Brich,    Bratio </span></span>
<span><span class="co">#&gt; min values  : 0.0008262028, 0.000000000, 0.0008262028, 0.0000000 </span></span>
<span><span class="co">#&gt; max values  : 0.0596566852, 0.009628569, 0.0596566852, 0.5905113</span></span></code></pre></div>
<p>The spatial beta diversity for PD indicates a slight change in the
evolutionary history of communities towards the south. However this
change is even lower compared to TD and FD, as evidenced by the smallest
values of Btotal (~0.06). The predominant component contributing to this
little change is also the richness difference (Brich), suggesting that
dissimilarities between each community (i.e. pixel) and its neighbors
are due to the loss or gain of evolutionary history. The Bratio also
indicates the predominance of Birch component in most communities.</p>
</div>
<div class="section level2">
<h2 id="betatemp-td">4.1.4 Beta temporal TD<a class="anchor" aria-label="anchor" href="#betatemp-td"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Beta temporal TD calculation</span></span>
<span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/temp.beta.html">temp.beta</a></span><span class="op">(</span><span class="va">bin1</span>, <span class="va">bin2</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 16, 16, 4  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.125, 0.125  (x, y)</span></span>
<span><span class="co">#&gt; extent      : -41, -39, -15, -13  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; names       :  Btotal_TD,   Brepl_TD,   Brich_TD, Bratio_TD </span></span>
<span><span class="co">#&gt; min values  : 0.02985075, 0.00000000, 0.02985075, 0.0000000 </span></span>
<span><span class="co">#&gt; max values  : 0.31578947, 0.09836066, 0.31578947, 0.6666667</span></span></code></pre></div>
<p>The temporal beta diversity for TD indicates that future communities
are expected to experience changes in their species composition,
predominantly towards the south, with Btotal reaching approximately 0.3.
The predominance of the Brich component suggests that these
dissimilarities are attributed to gains or losses of species. The Bratio
also indicates the predominance of Birch component in most
communities.</p>
</div>
<div class="section level2">
<h2 id="betatemp-fd">4.1.5 Beta temporal FD<a class="anchor" aria-label="anchor" href="#betatemp-fd"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Beta temporal FD calculation</span></span>
<span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/temp.beta.html">temp.beta</a></span><span class="op">(</span><span class="va">bin1</span>, <span class="va">bin2</span>, <span class="va">traits</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 16, 16, 4  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.125, 0.125  (x, y)</span></span>
<span><span class="co">#&gt; extent      : -41, -39, -15, -13  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; names       :  Btotal_FD,   Brepl_FD,   Brich_FD, Bratio_FD </span></span>
<span><span class="co">#&gt; min values  : 0.01733908, 0.00000000, 0.01012696, 0.0000000 </span></span>
<span><span class="co">#&gt; max values  : 0.17193290, 0.03741327, 0.17193290, 0.6872465</span></span></code></pre></div>
<p>The temporal beta diversity for FD indicates a less pronounced
pattern compared to TD, with smaller values of Btotal, reaching a
maximum of only 0.17. The Brich component is also predominant,
suggesting that the small dissimilarities can be attributed to gains or
losses of functional traits. The Bratio also indicates the predominance
of Birch component in most communities.</p>
</div>
<div class="section level2">
<h2 id="betatemp-pd">4.1.6 Beta temporal PD<a class="anchor" aria-label="anchor" href="#betatemp-pd"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Beta temporal PD calculation</span></span>
<span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/temp.beta.html">temp.beta</a></span><span class="op">(</span><span class="va">bin1</span>, <span class="va">bin2</span>, <span class="va">tree</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 16, 16, 4  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.125, 0.125  (x, y)</span></span>
<span><span class="co">#&gt; extent      : -41, -39, -15, -13  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; names       : Btotal_PD,  Brepl_PD,    Brich_PD, Bratio_PD </span></span>
<span><span class="co">#&gt; min values  : 0.0120217, 0.0000000, 0.009533166, 0.0000000 </span></span>
<span><span class="co">#&gt; max values  : 0.1792291, 0.0394096, 0.179229119, 0.7759122</span></span></code></pre></div>
<p>Likewise, the temporal beta diversity for PD indicates a less
pronounced pattern compared to TD, with smaller values of Btotal,
reaching a maximum of only 0.18. The Brich component is also
predominant, suggesting that the small dissimilarities can be attributed
to gains or losses of evolutionary history. The Bratio also indicates
the predominance of Birch component in most communities.</p>
</div>
<div class="section level2">
<h2 id="traits-avg">5 Traits average<a class="anchor" aria-label="anchor" href="#traits-avg"></a>
</h2>
<p>Calculating the average traits of species for each climate scenario
enables the evaluation of species traits that contribute the most to the
loss of suitable habitat. Unlike functional diversity, which combines
functional traits into an index, this approach provides direct insight
into spatial variations in average traits. This information can
complement the data necessary for delineating conservation priority
areas, as shifts in average traits—whether increasing or
decreasing—indicate the potential loss of species with specific
features. This is of particular significance given that functional
traits are closely tied to the ecological services provided by
species.</p>
</div>
<div class="section level2">
<h2 id="traits-ex">5.1 Traits average examples<a class="anchor" aria-label="anchor" href="#traits-ex"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Average traits calculation</span></span>
<span><span class="co"># Scenario 1</span></span>
<span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/spat.trait.html">spat.trait</a></span><span class="op">(</span><span class="va">bin1</span>, <span class="va">traits</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 16, 16, 12  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.125, 0.125  (x, y)</span></span>
<span><span class="co">#&gt; extent      : -41, -39, -15, -13  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; names       : Beak.~ulmen, Beak.~Nares, Beak.Width, Beak.Depth, Tarsu~ength, Wing.Length, ... </span></span>
<span><span class="co">#&gt; min values  :    22.12692,    14.00385,   7.046154,   8.526923,    25.15000,    117.0016, ... </span></span>
<span><span class="co">#&gt; max values  :    24.52903,    16.41452,   7.804545,   9.601515,    26.29828,    122.0379, ...</span></span>
<span></span>
<span><span class="co"># Scenario 2</span></span>
<span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/spat.trait.html">spat.trait</a></span><span class="op">(</span><span class="va">bin2</span>, <span class="va">traits</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 16, 16, 12  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.125, 0.125  (x, y)</span></span>
<span><span class="co">#&gt; extent      : -41, -39, -15, -13  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; names       : Beak.~ulmen, Beak.~Nares, Beak.Width, Beak.Depth, Tarsu~ength, Wing.Length, ... </span></span>
<span><span class="co">#&gt; min values  :    22.69623,    14.63019,   7.264151,   8.786792,    25.35849,    117.3358, ... </span></span>
<span><span class="co">#&gt; max values  :    26.23462,    17.70962,   8.151923,   9.942308,    27.38947,    128.2158, ...</span></span></code></pre></div>
<p>The average beak depth in the first scenario ranges from 8.5 to 9.6,
while in the second scenario, it ranges from 8.8 to 9.9. Beak depth
increased by 13.5% in the southern region but decreased by 4.5% in the
central region. The earlier analysis indicated a prevalence of species
loss, implying that the rise in average beak depth in the second
scenario can be attributed to the decline of species with smaller beak
depths. Conversely, the reduction in beak size can be attributed to the
decline of species with larger beak depths.</p>
</div>
<div class="section level2">
<h2 id="suit-change">6 Suitability change<a class="anchor" aria-label="anchor" href="#suit-change"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Suitability change between climate scenarios</span></span>
<span><span class="va">change</span> <span class="op">&lt;-</span> <span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/suit.change.html">suit.change</a></span><span class="op">(</span><span class="va">bin1</span>, <span class="va">bin2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualization</span></span>
<span><span class="co"># Initialize an empty list to store color mappings for each layer</span></span>
<span><span class="va">change.col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loop through each layer in the 'change' raster</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nlyr</a></span><span class="op">(</span><span class="va">change</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># Get unique values, omitting NA values, and sort them</span></span>
<span>  <span class="va">change.col</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/na.omit.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">change</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Map numeric values to specific colors</span></span>
<span>  <span class="va">change.col</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">change.col</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"blue"</span>   <span class="co"># Gain</span></span>
<span>  <span class="va">change.col</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">change.col</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"red"</span>    <span class="co"># Loss</span></span>
<span>  <span class="va">change.col</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">change.col</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"grey"</span>   <span class="co"># No change</span></span>
<span>  <span class="va">change.col</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">change.col</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">==</span> <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"white"</span>  <span class="co"># Unsuitable</span></span>
<span>  </span>
<span>  <span class="co"># Plot the change in suitability for the current species</span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">change</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="va">change.col</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, </span>
<span>              main <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">change</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>              cex.main <span class="op">=</span> <span class="fl">1</span>,          </span>
<span>              font.main <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-1.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-2.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-3.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-4.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-5.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-6.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-7.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-8.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-9.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-10.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-11.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-12.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-13.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-14.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-15.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-16.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-17.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-18.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-19.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-20.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-21.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-22.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-23.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-24.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-25.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-26.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-27.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-28.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-29.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-30.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-31.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-32.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-33.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-34.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-35.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-36.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-37.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-38.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-39.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-40.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-41.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-42.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-43.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-44.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-45.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-46.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-47.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-48.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-49.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-50.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-51.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-52.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-53.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-54.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-55.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-56.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-57.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-58.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-59.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-60.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-61.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-62.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-63.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-64.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-65.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-66.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-67.png" width="700"><img src="divraster-vignette_files/figure-html/unnamed-chunk-14-68.png" width="700">
Suitability change between climate scenarios with values equals 1
representing gain, values equals 2 representing loss, values equals 3
representing no change, and values equals 4 representing unsuitable in
both scenarios.</p>
</div>
<div class="section level2">
<h2 id="area-calc">7 Area calculation<a class="anchor" aria-label="anchor" href="#area-calc"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Climate suitable area scenario 1</span></span>
<span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/area.calc.html">area.calc</a></span><span class="op">(</span><span class="va">bin1</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        Layer       Area</span></span>
<span><span class="co">#&gt; 1           Amazona_farinosa 20247.9250</span></span>
<span><span class="co">#&gt; 2       Amazona_rhodocorytha 20247.9250</span></span>
<span><span class="co">#&gt; 3            Amazona_vinacea  4874.5005</span></span>
<span><span class="co">#&gt; 4      Arremon_semitorquatus   562.4424</span></span>
<span><span class="co">#&gt; 5         Arremon_taciturnus 20247.9250</span></span>
<span><span class="co">#&gt; 6      Pteroglossus_bailloni 14623.5014</span></span>
<span><span class="co">#&gt; 7               Cacicus_cela 20247.9250</span></span>
<span><span class="co">#&gt; 8        Carpornis_cucullata 20247.9250</span></span>
<span><span class="co">#&gt; 9  Caryothraustes_canadensis 20247.9250</span></span>
<span><span class="co">#&gt; 10       Chiroxiphia_caudata 19872.9635</span></span>
<span><span class="co">#&gt; 11       Chiroxiphia_pareola 20247.9250</span></span>
<span><span class="co">#&gt; 12        Chlorophanes_spiza 20247.9250</span></span>
<span><span class="co">#&gt; 13      Patagioenas_speciosa 20247.9250</span></span>
<span><span class="co">#&gt; 14          Cotinga_maculata 20247.9250</span></span>
<span><span class="co">#&gt; 15         Crax_blumenbachii 20247.9250</span></span>
<span><span class="co">#&gt; 16         Crypturellus_soui 20247.9250</span></span>
<span><span class="co">#&gt; 17   Crypturellus_variegatus 20247.9250</span></span>
<span><span class="co">#&gt; 18         Cyanerpes_cyaneus 20247.9250</span></span>
<span><span class="co">#&gt; 19         Elaenia_mesoleuca 20247.9250</span></span>
<span><span class="co">#&gt; 20     Euphonia_cyanocephala 20247.9250</span></span>
<span><span class="co">#&gt; 21       Euphonia_pectoralis 20247.9250</span></span>
<span><span class="co">#&gt; 22     Euphonia_xanthogaster 20247.9250</span></span>
<span><span class="co">#&gt; 23         Ilicura_militaris 19872.9635</span></span>
<span><span class="co">#&gt; 24          Iodopleura_pipra 12186.2512</span></span>
<span><span class="co">#&gt; 25         Laniisoma_elegans 20247.9250</span></span>
<span><span class="co">#&gt; 26       Legatus_leucophaius 20247.9250</span></span>
<span><span class="co">#&gt; 27        Lipaugus_lanioides 18185.6364</span></span>
<span><span class="co">#&gt; 28       Lipaugus_vociferans 20247.9250</span></span>
<span><span class="co">#&gt; 29    Machaeropterus_regulus 20247.9250</span></span>
<span><span class="co">#&gt; 30           Manacus_manacus 20247.9250</span></span>
<span><span class="co">#&gt; 31     Melanerpes_flavifrons 20247.9250</span></span>
<span><span class="co">#&gt; 32      Mionectes_oleagineus 20247.9250</span></span>
<span><span class="co">#&gt; 33     Mionectes_rufiventris 20060.4443</span></span>
<span><span class="co">#&gt; 34        Neopelma_aurifrons 20247.9250</span></span>
<span><span class="co">#&gt; 35     Odontophorus_capueira 15935.8669</span></span>
<span><span class="co">#&gt; 36       Oxyruncus_cristatus 20247.9250</span></span>
<span><span class="co">#&gt; 37   Pachyramphus_marginatus 20247.9250</span></span>
<span><span class="co">#&gt; 38       Patagioenas_plumbea 20247.9250</span></span>
<span><span class="co">#&gt; 39          Penelope_obscura 20247.9250</span></span>
<span><span class="co">#&gt; 40    Penelope_superciliaris 20247.9250</span></span>
<span><span class="co">#&gt; 41    Phibalura_flavirostris 18935.5595</span></span>
<span><span class="co">#&gt; 42   Phyllomyias_burmeisteri 20060.4443</span></span>
<span><span class="co">#&gt; 43       Pionopsitta_pileata 16498.3093</span></span>
<span><span class="co">#&gt; 44               Pipra_pipra 20247.9250</span></span>
<span><span class="co">#&gt; 45        Pipra_rubrocapilla 20247.9250</span></span>
<span><span class="co">#&gt; 46     Pipraeidea_melanonota 20247.9250</span></span>
<span><span class="co">#&gt; 47           Turdus_flavipes 20247.9250</span></span>
<span><span class="co">#&gt; 48       Procnias_nudicollis 20247.9250</span></span>
<span><span class="co">#&gt; 49     Psarocolius_decumanus 20247.9250</span></span>
<span><span class="co">#&gt; 50      Pteroglossus_aracari 20247.9250</span></span>
<span><span class="co">#&gt; 51        Pyroderus_scutatus 20247.9250</span></span>
<span><span class="co">#&gt; 52        Pyrrhura_cruentata 20247.9250</span></span>
<span><span class="co">#&gt; 53      Ramphastos_dicolorus 20060.4443</span></span>
<span><span class="co">#&gt; 54       Schiffornis_turdina 20247.9250</span></span>
<span><span class="co">#&gt; 55     Schiffornis_virescens 19310.5211</span></span>
<span><span class="co">#&gt; 56  Selenidera_maculirostris 20060.4443</span></span>
<span><span class="co">#&gt; 57 Stephanophorus_diadematus 16310.8285</span></span>
<span><span class="co">#&gt; 58     Tachyphonus_cristatus 20247.9250</span></span>
<span><span class="co">#&gt; 59      Tangara_cyanocephala 19685.4827</span></span>
<span><span class="co">#&gt; 60      Tangara_cyanoventris 16873.2709</span></span>
<span><span class="co">#&gt; 61        Tangara_desmaresti 17998.1556</span></span>
<span><span class="co">#&gt; 62           Tangara_seledon 20247.9250</span></span>
<span><span class="co">#&gt; 63       Thraupis_cyanoptera 16873.2709</span></span>
<span><span class="co">#&gt; 64        Tinamus_solitarius 20060.4443</span></span>
<span><span class="co">#&gt; 65         Touit_melanonotus 16685.7901</span></span>
<span><span class="co">#&gt; 66            Trogon_viridis 20247.9250</span></span>
<span><span class="co">#&gt; 67          Turdus_fumigatus 20247.9250</span></span>
<span><span class="co">#&gt; 68    Xipholena_atropurpurea 17998.1556</span></span>
<span></span>
<span><span class="co"># Climate suitable area scenario 2</span></span>
<span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/area.calc.html">area.calc</a></span><span class="op">(</span><span class="va">bin2</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        Layer       Area</span></span>
<span><span class="co">#&gt; 1           Amazona_farinosa 20247.9250</span></span>
<span><span class="co">#&gt; 2       Amazona_rhodocorytha 20247.9250</span></span>
<span><span class="co">#&gt; 3            Amazona_vinacea     0.0000</span></span>
<span><span class="co">#&gt; 4      Arremon_semitorquatus   374.9616</span></span>
<span><span class="co">#&gt; 5         Arremon_taciturnus 20247.9250</span></span>
<span><span class="co">#&gt; 6      Pteroglossus_bailloni 16685.7901</span></span>
<span><span class="co">#&gt; 7               Cacicus_cela 20247.9250</span></span>
<span><span class="co">#&gt; 8        Carpornis_cucullata 17998.1556</span></span>
<span><span class="co">#&gt; 9  Caryothraustes_canadensis 20247.9250</span></span>
<span><span class="co">#&gt; 10       Chiroxiphia_caudata 10123.9625</span></span>
<span><span class="co">#&gt; 11       Chiroxiphia_pareola 20247.9250</span></span>
<span><span class="co">#&gt; 12        Chlorophanes_spiza 20247.9250</span></span>
<span><span class="co">#&gt; 13      Patagioenas_speciosa 20247.9250</span></span>
<span><span class="co">#&gt; 14          Cotinga_maculata 20247.9250</span></span>
<span><span class="co">#&gt; 15         Crax_blumenbachii 20247.9250</span></span>
<span><span class="co">#&gt; 16         Crypturellus_soui 20247.9250</span></span>
<span><span class="co">#&gt; 17   Crypturellus_variegatus 20247.9250</span></span>
<span><span class="co">#&gt; 18         Cyanerpes_cyaneus 20247.9250</span></span>
<span><span class="co">#&gt; 19         Elaenia_mesoleuca 11998.7704</span></span>
<span><span class="co">#&gt; 20     Euphonia_cyanocephala 20247.9250</span></span>
<span><span class="co">#&gt; 21       Euphonia_pectoralis 18935.5595</span></span>
<span><span class="co">#&gt; 22     Euphonia_xanthogaster 20247.9250</span></span>
<span><span class="co">#&gt; 23         Ilicura_militaris 17248.2324</span></span>
<span><span class="co">#&gt; 24          Iodopleura_pipra 15185.9438</span></span>
<span><span class="co">#&gt; 25         Laniisoma_elegans 20247.9250</span></span>
<span><span class="co">#&gt; 26       Legatus_leucophaius 20247.9250</span></span>
<span><span class="co">#&gt; 27        Lipaugus_lanioides 19498.0019</span></span>
<span><span class="co">#&gt; 28       Lipaugus_vociferans 20247.9250</span></span>
<span><span class="co">#&gt; 29    Machaeropterus_regulus 20247.9250</span></span>
<span><span class="co">#&gt; 30           Manacus_manacus 20247.9250</span></span>
<span><span class="co">#&gt; 31     Melanerpes_flavifrons 18935.5595</span></span>
<span><span class="co">#&gt; 32      Mionectes_oleagineus 20247.9250</span></span>
<span><span class="co">#&gt; 33     Mionectes_rufiventris 10873.8857</span></span>
<span><span class="co">#&gt; 34        Neopelma_aurifrons 20247.9250</span></span>
<span><span class="co">#&gt; 35     Odontophorus_capueira 11623.8088</span></span>
<span><span class="co">#&gt; 36       Oxyruncus_cristatus 20247.9250</span></span>
<span><span class="co">#&gt; 37   Pachyramphus_marginatus 20247.9250</span></span>
<span><span class="co">#&gt; 38       Patagioenas_plumbea 20247.9250</span></span>
<span><span class="co">#&gt; 39          Penelope_obscura 20247.9250</span></span>
<span><span class="co">#&gt; 40    Penelope_superciliaris 20247.9250</span></span>
<span><span class="co">#&gt; 41    Phibalura_flavirostris 14061.0591</span></span>
<span><span class="co">#&gt; 42   Phyllomyias_burmeisteri  7499.2315</span></span>
<span><span class="co">#&gt; 43       Pionopsitta_pileata   374.9616</span></span>
<span><span class="co">#&gt; 44               Pipra_pipra 20247.9250</span></span>
<span><span class="co">#&gt; 45        Pipra_rubrocapilla 20247.9250</span></span>
<span><span class="co">#&gt; 46     Pipraeidea_melanonota 11248.8472</span></span>
<span><span class="co">#&gt; 47           Turdus_flavipes 20247.9250</span></span>
<span><span class="co">#&gt; 48       Procnias_nudicollis 19685.4827</span></span>
<span><span class="co">#&gt; 49     Psarocolius_decumanus 20247.9250</span></span>
<span><span class="co">#&gt; 50      Pteroglossus_aracari 20247.9250</span></span>
<span><span class="co">#&gt; 51        Pyroderus_scutatus 20247.9250</span></span>
<span><span class="co">#&gt; 52        Pyrrhura_cruentata 20247.9250</span></span>
<span><span class="co">#&gt; 53      Ramphastos_dicolorus 12373.7320</span></span>
<span><span class="co">#&gt; 54       Schiffornis_turdina 20247.9250</span></span>
<span><span class="co">#&gt; 55     Schiffornis_virescens  5061.9813</span></span>
<span><span class="co">#&gt; 56  Selenidera_maculirostris 19123.0403</span></span>
<span><span class="co">#&gt; 57 Stephanophorus_diadematus     0.0000</span></span>
<span><span class="co">#&gt; 58     Tachyphonus_cristatus 20247.9250</span></span>
<span><span class="co">#&gt; 59      Tangara_cyanocephala 18185.6364</span></span>
<span><span class="co">#&gt; 60      Tangara_cyanoventris  2062.2887</span></span>
<span><span class="co">#&gt; 61        Tangara_desmaresti 12748.6935</span></span>
<span><span class="co">#&gt; 62           Tangara_seledon 19872.9635</span></span>
<span><span class="co">#&gt; 63       Thraupis_cyanoptera   749.9231</span></span>
<span><span class="co">#&gt; 64        Tinamus_solitarius 16123.3477</span></span>
<span><span class="co">#&gt; 65         Touit_melanonotus 13123.6551</span></span>
<span><span class="co">#&gt; 66            Trogon_viridis 20247.9250</span></span>
<span><span class="co">#&gt; 67          Turdus_fumigatus 20247.9250</span></span>
<span><span class="co">#&gt; 68    Xipholena_atropurpurea 16685.7901</span></span></code></pre></div>
<p>The climate suitable area for species such as <em>Amazona
farinosa</em> is expected to remain the same (20,247 km2), while for
species such as <em>Arremon semitorquatus</em> is expected to reduce by
33%.</p>
</div>
<div class="section level2">
<h2 id="differ">8 Richness difference between scenarios<a class="anchor" aria-label="anchor" href="#differ"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Suitability change between climate scenarios</span></span>
<span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/differ.rast.html">differ.rast</a></span><span class="op">(</span><span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/spat.alpha2.html">spat.alpha2</a></span><span class="op">(</span><span class="va">bin1</span><span class="op">)</span>,</span>
<span>                       <span class="fu">divraster</span><span class="fu">::</span><span class="fu"><a href="../reference/spat.alpha2.html">spat.alpha2</a></span><span class="op">(</span><span class="va">bin2</span><span class="op">)</span>, perc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 16, 16, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.125, 0.125  (x, y)</span></span>
<span><span class="co">#&gt; extent      : -41, -39, -15, -13  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; name        : Absolute_Difference </span></span>
<span><span class="co">#&gt; min value   :                 -18 </span></span>
<span><span class="co">#&gt; max value   :                  -2</span></span></code></pre></div>
<p>When comparing the two scenarios, subtracting the second from the
first reveals greater species losses (n = 18) towards the south.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Flávio M. M. Mota, Neander Marcel Heming, Gabriela Alves-Ferreira.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
